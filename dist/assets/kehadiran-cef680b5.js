import{_ as $,j as I,r as m,k as L,i as V,g as S,b as i,o as k,c as D,d as l,e as o,l as r,m as T,t as B,n as K,p as J,f as M}from"./index-8bbbcb13.js";import{E as j,u as w,w as R}from"./xlsx-e492dd4f.js";const P=_=>(J("data-v-279252ce"),_=_(),M(),_),U={class:"grid"},Y={class:"col-12"},z={class:"card"},H={class:"my-2"},O={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},q=P(()=>l("h5",{class:"m-0"},"Manage Attendance",-1)),G={class:"flex align-items-center justify-content-center"},Q=P(()=>l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),W={key:0},X={__name:"kehadiran",setup(_){const c=I(),d=m({name:"",JamKehadiran:""}),v=m([]),u=m(!1),b=m(null),f=m({});L(()=>{E()}),V(async()=>{try{const t=await S.get("https://apiinvit.vercel.app/api/kehadiran");v.value=t.data}catch{c.add({severity:"error",summary:"Error",detail:"Failed to fetch attendance data",life:3e3})}});const E=()=>{f.value={global:{value:null}}},A=t=>{d.value=t,u.value=!0},C=async()=>{try{const t=d.value._id;await S.delete(`https://apiinvit.vercel.app/api/kehadiran/${t}`),c.add({severity:"success",summary:"Successful",detail:"Attendance Deleted",life:1e3}),setTimeout(()=>{window.location.reload()},1e3)}catch{c.add({severity:"error",summary:"Error",detail:"Failed to delete attendance",life:3e3})}finally{u.value=!1,d.value={}}},h=t=>{const e=new Date(t),a=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),y=String(e.getSeconds()).padStart(2,"0"),p=e.getFullYear(),g=String(e.getMonth()+1).padStart(2,"0"),x=String(e.getDate()).padStart(2,"0");return`${a}:${n}:${y} ${p}-${g}-${x}`},F=()=>{const t=new j;t.setFontSize(16),t.text("Attendance Data",14,10);const e=v.value.map(n=>[n.name,h(n.JamKehadiran)]),a=["Name","Attendance Time"];t.autoTable({head:[a],body:e,startY:20}),t.save("attendance.pdf"),c.add({severity:"success",summary:"Exported to PDF",detail:"PDF Export Successful",life:3e3})},N=()=>{const t=v.value.map(n=>({Name:n.name,"Attendance Time":h(n.JamKehadiran)})),e=w.json_to_sheet(t),a=w.book_new();w.book_append_sheet(a,e,"Attendance Data"),R(a,"attendance.xlsx"),c.add({severity:"success",summary:"Exported to Excel",detail:"Excel Export Successful",life:3e3})};return(t,e)=>{const a=i("Button"),n=i("Toolbar"),y=i("InputText"),p=i("Column"),g=i("DataTable"),x=i("Dialog");return k(),D("div",U,[l("div",Y,[l("div",z,[o(n,{class:"mb-4"},{start:r(()=>[l("div",H,[o(a,{label:"Export to PDF",icon:"pi pi-file-pdf",class:"mr-2",severity:"primary",onClick:F}),o(a,{label:"Export to Excel",icon:"pi pi-file-excel",severity:"primary",onClick:N})])]),_:1}),o(g,{value:v.value,selection:b.value,"onUpdate:selection":e[1]||(e[1]=s=>b.value=s),dataKey:"_id",paginator:!0,rows:10,filters:f.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Attendance"},{header:r(()=>[l("div",O,[q,o(y,{class:"w-full sm:w-auto",modelValue:f.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=s=>f.value.global.value=s),placeholder:"Search..."},null,8,["modelValue"])])]),default:r(()=>[o(p,{field:"name",header:"Name",sortable:!0,headerStyle:"width:50%;"}),o(p,{field:"JamKehadiran",header:"Attendance Time",sortable:!0,headerStyle:"width:50%;",body:h}),o(p,{headerStyle:"min-width:10rem;"},{body:r(s=>[o(a,{icon:"pi pi-trash",class:"mt-2",severity:"warning",rounded:"",onClick:Z=>A(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),o(x,{visible:u.value,"onUpdate:visible":e[3]||(e[3]=s=>u.value=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[o(a,{label:"No",icon:"pi pi-times",text:"",onClick:e[2]||(e[2]=s=>u.value=!1)}),o(a,{label:"Yes",icon:"pi pi-check",text:"",onClick:C})]),default:r(()=>[l("div",G,[Q,d.value?(k(),D("span",W,[T("Are you sure you want to delete "),l("b",null,B(d.value.name),1),T("?")])):K("",!0)])]),_:1},8,["visible"])])])])}}},ae=$(X,[["__scopeId","data-v-279252ce"]]);export{ae as default};
